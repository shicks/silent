"use strict";(()=>{var M=document.getElementById("out"),I=document.getElementById("values"),g=document.getElementById("sensitivity"),f=document.getElementById("volume");function r(){i=Number(f.value)/100,n=4*2**(Number(g.value)/100*12),console.log(`knobs: ${i} ${n}`)}var i=0,n=1024;g.addEventListener("change",r);f.addEventListener("change",r);r();function q(b){let e=new AudioContext,h=e.createMediaStreamSource(b),t=e.createAnalyser(),o=e.createOscillator();o.type="sawtooth";let B=t.frequencyBinCount/24*e.sampleRate/t.fftSize;o.frequency.value=B;let d=0,a=e.createGain();a.connect(e.destination),a.gain.value=0,h.connect(t),o.connect(a),o.start(0);let m=new Uint8Array(t.frequencyBinCount),s=0,c=0;function v(){console.log("play"),d++,t.getByteFrequencyData(m);let l=0;for(let u=0;u<t.frequencyBinCount;u++)l+=m[u];s=Math.max(l,s*.97);let y=l>c?.05:.02;c=c*(1-y)+l*y;let E=`hsl(${Math.max(0,(3*n-c)/(3*n)*120)}deg 100% 50%)`;M.style.background=E,a.gain.value=s>n&&d/30&1?i:0,requestAnimationFrame(v)}v()}navigator.getUserMedia({video:!1,audio:!0},q,console.log);})();
